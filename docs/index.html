<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ± Smart Greenhouse</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 { color: #333; font-size: 2.5em; margin-bottom: 10px; }
        .subtitle { color: #666; font-size: 1.1em; }
        .status {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-weight: bold;
        }
        .status.online { background: #4CAF50; color: white; }
        .status.offline { background: #f44336; color: white; }
        .status.loading { background: #FF9800; color: white; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        .metric-card:hover { transform: translateY(-5px); }
        .metric-icon { font-size: 3em; margin-bottom: 10px; }
        .metric-value { font-size: 3em; font-weight: bold; margin: 10px 0; }
        .metric-label { font-size: 1.1em; opacity: 0.9; }
        .metric-unit { font-size: 1.2em; opacity: 0.8; margin-top: 5px; }
        
        .info-box {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
        }
        .info-box p { margin: 10px 0; color: #666; }
        .info-box strong { color: #333; }
        
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff5722;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideIn 0.3s;
            z-index: 1000;
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ± Smart Greenhouse</h1>
            <p class="subtitle">Î‘Ï€Î¿Î¼Î±ÎºÏÏ…ÏƒÎ¼Î­Î½Î· Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ·</p>
            <div id="status" class="status loading">Î£ÏÎ½Î´ÎµÏƒÎ·...</div>
        </header>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-icon">ğŸŒ¡ï¸</div>
                <div class="metric-value" id="temperature">--</div>
                <div class="metric-label">Î˜ÎµÏÎ¼Î¿ÎºÏÎ±ÏƒÎ¯Î±</div>
                <div class="metric-unit">Â°C</div>
            </div>

            <div class="metric-card">
                <div class="metric-icon">ğŸŒŠ</div>
                <div class="metric-value" id="pressure">----</div>
                <div class="metric-label">Î Î¯ÎµÏƒÎ·</div>
                <div class="metric-unit">hPa</div>
            </div>

            <div class="metric-card">
                <div class="metric-icon">ğŸ’¡</div>
                <div class="metric-value" id="light">--</div>
                <div class="metric-label">Î¦Ï‰Ï„ÎµÎ¹Î½ÏŒÏ„Î·Ï„Î±</div>
                <div class="metric-unit">lux</div>
            </div>

            <div class="metric-card">
                <div class="metric-icon">ğŸ’§</div>
                <div class="metric-value" id="soil">--</div>
                <div class="metric-label">Î¥Î³ÏÎ±ÏƒÎ¯Î± Î•Î´Î¬Ï†Î¿Ï…Ï‚</div>
                <div class="metric-unit">%</div>
            </div>
        </div>

        <div class="info-box">
            <p><strong>Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·:</strong> <span id="lastUpdate">--</span></p>
            <p><strong>Device ID:</strong> ESP32-Greenhouse</p>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDwwszw4AapfTp_dkdli48vsxOZXkZwqfo",
            authDomain: "smartgreenhouse-fb494.firebaseapp.com",
            databaseURL: "https://smartgreenhouse-fb494-default-rtdb.firebaseio.com",
            projectId: "smartgreenhouse-fb494",
            storageBucket: "smartgreenhouse-fb494.firebasestorage.app",
            messagingSenderId: "655885291578",
            appId: "1:655885291578:web:cd006776213994db2ea503"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Device ID
        const DEVICE_ID = 'ESP32-Greenhouse';

        // Listen for real-time updates
        const latestRef = ref(database, `sensors/${DEVICE_ID}/latest`);
        
        onValue(latestRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                updateDisplay(data);
                document.getElementById('status').textContent = 'ğŸŸ¢ Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿';
                document.getElementById('status').className = 'status online';
            } else {
                document.getElementById('status').textContent = 'âš ï¸ Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±...';
                document.getElementById('status').className = 'status loading';
            }
        }, (error) => {
            console.error('Firebase error:', error);
            document.getElementById('status').textContent = 'ğŸ”´ Î£Ï†Î¬Î»Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚';
            document.getElementById('status').className = 'status offline';
        });

        function updateDisplay(data) {
            document.getElementById('temperature').textContent = 
                data.temperature ? data.temperature.toFixed(2) : '--';
            document.getElementById('pressure').textContent = 
                data.pressure ? data.pressure.toFixed(2) : '----';
            document.getElementById('light').textContent = 
                data.light ? data.light.toFixed(2) : '--';
            document.getElementById('soil').textContent = 
                data.soilMoisture !== undefined ? data.soilMoisture.toFixed(0) : '--';
            
            const timestamp = data.timestamp ? new Date(data.timestamp).toLocaleString('el-GR') : '--';
            document.getElementById('lastUpdate').textContent = timestamp;

            // Add alerts if needed
            if (data.temperature > 35) {
                showAlert('ğŸ”¥ Î¥ÏˆÎ·Î»Î® Î¸ÎµÏÎ¼Î¿ÎºÏÎ±ÏƒÎ¯Î±!');
            }
            if (data.soilMoisture < 20) {
                showAlert('ğŸ’§ Î§Î±Î¼Î·Î»Î® Ï…Î³ÏÎ±ÏƒÎ¯Î± ÎµÎ´Î¬Ï†Î¿Ï…Ï‚!');
            }
        }

        let alertTimeout;
        function showAlert(message) {
            clearTimeout(alertTimeout);
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert';
            alertDiv.textContent = message;
            document.body.appendChild(alertDiv);
            alertTimeout = setTimeout(() => alertDiv.remove(), 5000);
        }
    </script>
</body>
</html>
